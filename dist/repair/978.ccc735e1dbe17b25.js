"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[978],{978:(R,u,r)=>{r.r(u),r.d(u,{EquipmentModule:()=>k});var h=r(6814),c=r(132),m=r(5861),g=r(3839),U=r(450),d=r(9862),T=r(9947),e=r(9212);let p=(()=>{class s{constructor(t){this.http=t,this.apiHost=T.N.hostUrl,this.apiUrl=`${this.apiHost}productTypes`,this.httpOptions={headers:new d.WM({"Content-Type":"application/json"})}}getAllProductTypes(){return this.http.get(this.apiUrl)}getProductTypeById(t){return this.http.get(`${this.apiUrl}/${t}`)}addProductType(t){return this.http.post(this.apiUrl,t,this.httpOptions)}updateProductType(t,i){return this.http.put(`${this.apiUrl}/${t}`,i,this.httpOptions)}deleteProductType(t){return this.http.delete(`${this.apiUrl}/${t}`)}static{this.\u0275fac=function(i){return new(i||s)(e.LFG(d.eN))}}static{this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})(),O=(()=>{class s{constructor(t){this.http=t,this.apiHost=T.N.hostUrl,this.apiUrl=`${this.apiHost}reviews`,this.httpOptions={headers:new d.WM({"Content-Type":"application/json"})}}getAllReviews(){return this.http.get(this.apiUrl)}getReviewById(t){return this.http.get(`${this.apiUrl}/${t}`)}addReview(t){return this.http.post(this.apiUrl,t,this.httpOptions)}updateReview(t,i){return this.http.put(`${this.apiUrl}/${t}`,i,this.httpOptions)}deleteReview(t){return this.http.delete(`${this.apiUrl}/${t}`)}static{this.\u0275fac=function(i){return new(i||s)(e.LFG(d.eN))}}static{this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var $=r(3630),E=r(5993),F=r(4036),B=r(7635),M=r(2022),P=r(6463),Y=r(5219),N=r(9567),J=r(3282);let S=(()=>{class s{constructor(t,i,o,a,n,f,y,l,_){this.brandService=t,this.categoryService=i,this.productTypeService=o,this.reviewService=a,this.productService=n,this.messageService=f,this.fileService=y,this.route=l,this.toast=_,this.formData={},this.editMode=!1,this.isUploading=!1,this.computed=b=>{let A=new M.n,C=new P.q;this.editMode&&(this.categoryService.getCategoryByName(this.formData.category).subscribe(D=>{A=D,b.patchValue({category:A.id})}),this.brandService.getBrandByName(this.formData.brand).subscribe(D=>{C=D,b.patchValue({brand:C.id})}))},this.product={id:0,title:"",quantity:0,price:0,description:"",brand:new P.q,category:new M.n,imageUrl:""},this.services=[{brands:this.brandService.getAllBrands(),categories:this.categoryService.getAllCategories()}]}ngOnInit(){this.route.snapshot.paramMap.get("formData")&&(this.formData=JSON.parse(this.route.snapshot.paramMap.get("formData")??"{}"),this.editMode=!0)}addProduct(t){var i=this;return(0,m.Z)(function*(){if(!t)return void i.show("Error","Please provide all required fields for EquipmentDetail !","error");const o={id:String,name:""};o.id=t.brand;const a={id:String,name:""};a.id=t.category;const f={id:i.editMode?t.id:null,title:t.title,price:t.price,oldPrice:null,quantity:t.quantity,description:t.description,brand:o,category:a,productType:{id:null,name:"Electronic"},sellCount:-1,featured:!1,imageUrl:t.image?URL.createObjectURL(t.image):"",condition:$.G3.New},y=t.image;i.editMode?i.productService.updateProduct(t.id,f).subscribe({next:l=>{i.fileService.uploadImage(y,l.imageUrl,"products"),i.toast.showSuccess("Product was updated successfully!")},error:l=>{console.error(l),i.toast.showError("Failed to update Product. Please try again.")}}):i.productService.addProduct(f).subscribe({next:l=>{i.fileService.uploadImage(y,l.imageUrl,"products"),i.toast.showSuccess("Product was added successfully!")},error:l=>{console.error(l),i.toast.showError("Failed to add Product. Please try again.")}})})()}show(t,i,o){this.messageService.add({severity:o,summary:t,detail:i})}getReview(t){var i=this;return(0,m.Z)(function*(){return yield(0,F.z)(i.reviewService.getReviewById(t))})()}generateRandom(){const t=Math.random()*(new Date).getMilliseconds();return Math.floor(t%1e5)}static{this.\u0275fac=function(i){return new(i||s)(e.Y36(g.c),e.Y36(U.H),e.Y36(p),e.Y36(O),e.Y36(E.M),e.Y36(Y.ez),e.Y36(B.I),e.Y36(c.gz),e.Y36(N.k))}}static{this.\u0275cmp=e.Xpm({type:s,selectors:[["app-add-equipment"]],decls:2,vars:5,consts:[[1,"col-12"],["title","equipment",3,"sub","services","formData","model","computed","isModal"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"generator-form",1),e.NdJ("sub",function(n){return o.addProduct(n)}),e.qZA()()),2&i&&(e.xp6(),e.Q6J("services",o.services)("formData",o.formData)("model",o.product)("computed",o.computed)("isModal",!1))},dependencies:[J.x],encapsulation:2})}}return s})();var z=r(8180),Z=r(9397),H=r(2333),v=r(4992),w=r(3530),L=r(537),j=r(4830),I=r(6925);const W=()=>({width:"70%",padding:"0px"}),V=()=>({"background-color":"#f9f9f9"}),G=[{path:"",component:(()=>{class s{constructor(t,i,o){this.productService=t,this.router=i,this.auth=o,this.loading=!1,this.dataRows=[],this.showDetail=!1,this.rowDetail={},this.publicHost=T.N.publicHost,this.user=null,this.productMapping={id:a=>a.id,sku:a=>a.sku,imageUrl:a=>this.publicHost.concat("/images/").concat(a.imageUrl),title:a=>a.title,price:a=>a.price,quantity:a=>a.quantity,description:a=>a.description,status:a=>a.status,brand:a=>a.brand?.name??"",category:a=>a.category?.name??""}}ngOnInit(){this.user=this.auth.getSignedUser(),this.productService.getAllProducts().pipe((0,z.q)(1),(0,Z.b)(t=>{this.dataRows=t})).subscribe()}onEvent(t,i){"Add"==t?this.router.navigate(["/equipments/add"]):t.eventType&&"edit"===t.eventType?(delete t.eventType,this.router.navigate(["/equipments/edit",{formData:JSON.stringify(t)}])):t.eventType&&"delete"===t.eventType?(delete t.eventType,this.delete(t)):t.eventType&&"show"===t.eventType&&(delete t.eventType,this.showDetail=!0,this.rowDetail=t)}delete(t){this.productService.deleteProduct(t.id).subscribe({next:i=>{let o=this.dataRows.findIndex(a=>a.id==t.id);if(-1!==o){let a=this.dataRows.splice(o,1);this.dataRows=this.dataRows.filter(n=>n.id!==a[0].id)}},error:i=>{console.error("Error adding product:",i)}})}canAddItem(){return(0,v.F)(this.user,"create:equipments")}canViewItem(){return(0,v.F)(this.user,"view:equipments")}canDeleteItem(){return(0,v.F)(this.user,"delete:equipments")}canUpdateItem(){return(0,v.F)(this.user,"update:equipments")}static{this.\u0275fac=function(i){return new(i||s)(e.Y36(E.M),e.Y36(c.F0),e.Y36(H.e))}}static{this.\u0275cmp=e.Xpm({type:s,selectors:[["app-equipment"]],decls:8,vars:23,consts:[[3,"visibleChange","modal","header","draggable","visible","contentStyle","styleClass","closeOnEscape","dismissableMask","resizable"],[1,"col-12"],["name","equipments",1,"detail",3,"dataRow"],[1,"grid"],[1,"card"],["name","equipments",3,"event","paginate","dataRows","canAddItem","deletable","editable","haveDetails","mapping"]],template:function(i,o){1&i&&(e.TgZ(0,"p-dialog",0),e.ALo(1,"translate"),e.Uc_("visibleChange",function(n){return e.nJJ(o.showDetail,n)||(o.showDetail=n),n}),e.TgZ(2,"div",1),e._UZ(3,"generator-detail",2),e.qZA()(),e.TgZ(4,"div",3)(5,"div",1)(6,"div",4)(7,"generator-table",5),e.NdJ("event",function(n){return o.onEvent(n)}),e.qZA()()()()),2&i&&(e.Akn(e.DdM(21,W)),e.Q6J("modal",!0)("header",e.lcZ(1,19,"equipments.detail"))("draggable",!0),e.E3D("visible",o.showDetail),e.Q6J("contentStyle",e.DdM(22,V))("styleClass","custom-dialog")("closeOnEscape",!0)("dismissableMask",!0)("resizable",!0),e.xp6(3),e.Q6J("dataRow",o.rowDetail),e.xp6(4),e.Q6J("paginate",!1)("dataRows",o.dataRows)("canAddItem",o.canAddItem())("deletable",o.canDeleteItem())("editable",o.canUpdateItem())("haveDetails",o.canUpdateItem())("mapping",o.productMapping))},dependencies:[w.V,L.j,j.u,I.X$],encapsulation:2})}}return s})()},{path:"add",data:{breadcrumb:"equipment.add"},component:S},{path:"edit",data:{breadcrumb:"equipment.edit"},component:S}];let Q=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=e.oAB({type:s})}static{this.\u0275inj=e.cJS({imports:[c.Bz.forChild(G),c.Bz]})}}return s})();var q=r(4956),K=r(4862),X=r(4104),x=r(7830);let k=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=e.oAB({type:s})}static{this.\u0275inj=e.cJS({imports:[h.ez,Q,w.S,q.S,K.X,X.EV,x.d,I.aw]})}}return s})()},5993:(R,u,r)=>{r.d(u,{M:()=>U});var h=r(9862),c=r(8504),m=r(9947),g=r(9212);let U=(()=>{class d{constructor(e){this.http=e,this.apiHost=m.N.hostUrl,this.apiUrl=`${this.apiHost}equipments`,this.httpOptions={headers:new h.WM({"Content-Type":"application/json"})}}getAllProducts(){return this.http.get(this.apiUrl)}getProductsByBrand(e){return this.http.get(`${this.apiUrl}/find?brand=${e}`)}getProductById(e){return this.http.get(`${this.apiUrl}/${e}`)}addProduct(e){return this.http.post(this.apiUrl,e,this.httpOptions)}updateProduct(e,p){return this.http.put(`${this.apiUrl}/${e}`,p,this.httpOptions)}deleteProduct(e){return this.http.delete(`${this.apiUrl}/${e}`)}handleError(e){return console.error("An error occurred:",e.message),(0,c._)("Something went wrong. Please try again later.")}static{this.\u0275fac=function(p){return new(p||d)(g.LFG(h.eN))}}static{this.\u0275prov=g.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()}}]);