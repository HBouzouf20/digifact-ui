"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[426],{1426:(Y,d,s)=>{s.r(d),s.d(d,{CategoryModule:()=>O});var p=s(6814),l=s(132),u=s(8180),y=s(9397),c=s(450),f=s(9947),e=s(9212),g=s(3530),v=s(537),C=s(4830),m=s(6925);const D=()=>({width:"70%",padding:"0px"}),S=()=>({"background-color":"#f9f9f9"});let M=(()=>{class r{constructor(t,a){this.categoryService=t,this.router=a,this.loading=!1,this.dataRows=[],this.showDetail=!1,this.rowDetail={},this.publicHost=f.N.publicHost,this.categoryMapping={id:o=>o.id,name:o=>o.name,status:o=>o.status,imageUrl:o=>this.publicHost.concat("/images/").concat(o.imageUrl)}}ngOnInit(){this.categoryService.getAllCategories().pipe((0,u.q)(1),(0,y.b)(t=>{this.dataRows=t})).subscribe()}onEvent(t,a){"Add"==t?this.router.navigate(["/categories/add"]):t.eventType&&"edit"===t.eventType?(delete t.eventType,console.log(t),this.router.navigate(["/categories/edit",{formData:JSON.stringify(t)}])):t.eventType&&"delete"===t.eventType?(delete t.eventType,this.delete(t)):t.eventType&&"show"===t.eventType&&(delete t.eventType,this.showDetail=!0,this.rowDetail=t)}delete(t){this.categoryService.deleteCategory(t.id).subscribe({next:a=>{let o=this.dataRows.findIndex(n=>n.id==t.id);if(-1!==o){let n=this.dataRows.splice(o,1);this.dataRows=this.dataRows.filter(i=>i.id!==n[0].id)}},error:a=>{console.error("Error adding category:",a)}})}static{this.\u0275fac=function(a){return new(a||r)(e.Y36(c.H),e.Y36(l.F0))}}static{this.\u0275cmp=e.Xpm({type:r,selectors:[["app-category"]],decls:8,vars:18,consts:[[3,"visibleChange","modal","header","draggable","visible","contentStyle","styleClass","closeOnEscape","dismissableMask","resizable"],[1,"col-12"],["name","category",1,"detail",3,"dataRow"],[1,"grid"],[1,"card"],["name","category",3,"event","dataRows","mapping"]],template:function(a,o){1&a&&(e.TgZ(0,"p-dialog",0),e.ALo(1,"translate"),e.Uc_("visibleChange",function(i){return e.nJJ(o.showDetail,i)||(o.showDetail=i),i}),e.TgZ(2,"div",1),e._UZ(3,"generator-detail",2),e.qZA()(),e.TgZ(4,"div",3)(5,"div",1)(6,"div",4)(7,"generator-table",5),e.NdJ("event",function(i){return o.onEvent(i)}),e.qZA()()()()),2&a&&(e.Akn(e.DdM(16,D)),e.Q6J("modal",!0)("header",e.lcZ(1,14,"category.detail"))("draggable",!0),e.E3D("visible",o.showDetail),e.Q6J("contentStyle",e.DdM(17,S))("styleClass","custom-dialog")("closeOnEscape",!0)("dismissableMask",!0)("resizable",!0),e.xp6(3),e.Q6J("dataRow",o.rowDetail),e.xp6(4),e.Q6J("dataRows",o.dataRows)("mapping",o.categoryMapping))},dependencies:[g.V,v.j,C.u,m.X$],encapsulation:2})}}return r})();var T=s(5861),b=s(2022),w=s(7635),R=s(5219),J=s(9567),A=s(3282);let h=(()=>{class r{constructor(t,a,o,n,i){this.categoryService=t,this.messageService=a,this.route=o,this.fileService=n,this.toast=i,this.formData={},this.editMode=!1,this.computed=H=>{},this.isUploading=!1,this.model=new b.n,this.services=[{}]}ngOnInit(){this.route.snapshot.paramMap.get("formData")&&(this.formData=JSON.parse(this.route.snapshot.paramMap.get("formData")??"{}"),this.editMode=!0)}addCategory(t){var a=this;return(0,T.Z)(function*(){if(!t)return void a.show("Error","Please provide all required fields for EquipmentDetail !","error");const o={id:a.editMode?t.id:null,name:t.name,status:t.status,imageUrl:t.image?URL.createObjectURL(t.image):""},n=t.image;a.editMode?a.categoryService.updateCategory(t.id,o).subscribe({next:i=>{a.fileService.uploadImage(n,i.imageUrl,"categories"),a.toast.showSuccess("Category was updated successfully!")},error:i=>{console.error(i),a.toast.showError("Failed to update Category. Please try again.")}}):a.categoryService.addCategory(o).subscribe({next:i=>{a.fileService.uploadImage(n,i.imageUrl,"categories"),a.toast.showSuccess("Category was added successfully!")},error:i=>{console.error(i),a.toast.showError("Failed to add Category. Please try again.")}})})()}show(t,a,o){this.messageService.add({severity:o,summary:t,detail:a})}generateRandom(){const t=Math.random()*(new Date).getMilliseconds();return console.log(t),Math.floor(t%1e5)}static{this.\u0275fac=function(a){return new(a||r)(e.Y36(c.H),e.Y36(R.ez),e.Y36(l.gz),e.Y36(w.I),e.Y36(J.k))}}static{this.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-category"]],decls:2,vars:3,consts:[[1,"col-12"],["title","category",3,"sub","formData","model","isModal"]],template:function(a,o){1&a&&(e.TgZ(0,"div",0)(1,"generator-form",1),e.NdJ("sub",function(i){return o.addCategory(i)}),e.qZA()()),2&a&&(e.xp6(),e.Q6J("formData",o.formData)("model",o.model)("isModal",!1))},dependencies:[A.x],encapsulation:2})}}return r})();const E=[{path:"",component:M},{path:"add",data:{breadcrumb:"category.add"},component:h},{path:"edit",data:{breadcrumb:"category.edit"},component:h}];let U=(()=>{class r{static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275mod=e.oAB({type:r})}static{this.\u0275inj=e.cJS({imports:[l.Bz.forChild(E),l.Bz]})}}return r})();var Z=s(4956),I=s(4862),F=s(4104),z=s(7830);let O=(()=>{class r{static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275mod=e.oAB({type:r})}static{this.\u0275inj=e.cJS({imports:[p.ez,U,g.S,Z.S,I.X,F.EV,z.d,m.aw]})}}return r})()}}]);