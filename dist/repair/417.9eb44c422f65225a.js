"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[417],{5417:(Q,u,i)=>{i.r(u),i.d(u,{IssueModule:()=>Y});var g=i(6814),d=i(132),f=i(8180),v=i(9397),c=i(7375),l=i(4992),I=i(2333),e=i(9212),h=i(3530),y=i(537),D=i(4830),m=i(6925);const b=()=>({width:"70%",padding:"0px"}),M=()=>({"background-color":"#f9f9f9"});let w=(()=>{class o{constructor(s,t,a){this.issueService=s,this.router=t,this.auth=a,this.loading=!1,this.dataRows=[],this.showDetail=!1,this.rowDetail={},this.user=null,this.issueMapping={id:r=>r.id,label:r=>r.label}}canAddItem(){return(0,l.F)(this.user,"create:clients")}canViewItem(){return(0,l.F)(this.user,"view:clients")}canDeleteItem(){return(0,l.F)(this.user,"delete:clients")}canUpdateItem(){return(0,l.F)(this.user,"update:clients")}ngOnInit(){this.user=this.auth.getSignedUser(),this.issueService.getAllIssues().pipe((0,f.q)(1),(0,v.b)(s=>{this.dataRows=s})).subscribe()}onEvent(s,t){"Add"==s?this.router.navigate(["/issues/add"]):s.eventType&&"edit"===s.eventType?(delete s.eventType,this.router.navigate(["/issues/edit",{formData:JSON.stringify(s)}])):s.eventType&&"delete"===s.eventType?(delete s.eventType,this.delete(s)):s.eventType&&"show"===s.eventType&&(delete s.eventType,this.showDetail=!0,this.rowDetail=s)}delete(s){this.issueService.deleteIssue(s.id).subscribe({next:t=>{let a=this.dataRows.findIndex(r=>r.id==s.id);if(-1!==a){let r=this.dataRows.splice(a,1);this.dataRows=this.dataRows.filter(n=>n.id!==r[0].id)}},error:t=>{console.error("Error adding issue:",t)}})}static{this.\u0275fac=function(t){return new(t||o)(e.Y36(c.v),e.Y36(d.F0),e.Y36(I.e))}}static{this.\u0275cmp=e.Xpm({type:o,selectors:[["app-issue"]],decls:8,vars:23,consts:[[3,"visibleChange","modal","header","draggable","visible","contentStyle","styleClass","closeOnEscape","dismissableMask","resizable"],[1,"col-12"],["name","issue",1,"detail",3,"dataRow"],[1,"grid"],[1,"card"],["name","issue",3,"event","paginate","dataRows","canAddItem","deletable","editable","haveDetails","mapping"]],template:function(t,a){1&t&&(e.TgZ(0,"p-dialog",0),e.ALo(1,"translate"),e.Uc_("visibleChange",function(n){return e.nJJ(a.showDetail,n)||(a.showDetail=n),n}),e.TgZ(2,"div",1),e._UZ(3,"generator-detail",2),e.qZA()(),e.TgZ(4,"div",3)(5,"div",1)(6,"div",4)(7,"generator-table",5),e.NdJ("event",function(n){return a.onEvent(n)}),e.qZA()()()()),2&t&&(e.Akn(e.DdM(21,b)),e.Q6J("modal",!0)("header",e.lcZ(1,19,"issue.detail"))("draggable",!0),e.E3D("visible",a.showDetail),e.Q6J("contentStyle",e.DdM(22,M))("styleClass","custom-dialog")("closeOnEscape",!0)("dismissableMask",!0)("resizable",!0),e.xp6(3),e.Q6J("dataRow",a.rowDetail),e.xp6(4),e.Q6J("paginate",!1)("dataRows",a.dataRows)("canAddItem",a.canAddItem())("deletable",a.canDeleteItem())("editable",a.canUpdateItem())("haveDetails",a.canUpdateItem())("mapping",a.issueMapping))},dependencies:[h.V,y.j,D.u,m.X$],encapsulation:2})}}return o})();var S=i(5861);class T{constructor(U){this.id=0,this.label="",Object.assign(this,U)}}var A=i(5219),C=i(9567),J=i(3282);let p=(()=>{class o{constructor(s,t,a,r){this.issueService=s,this.messageService=t,this.route=a,this.toast=r,this.formData={},this.editMode=!1,this.computed=n=>{},this.model=new T,this.services=[{}]}ngOnInit(){this.route.snapshot.paramMap.get("formData")&&(this.formData=JSON.parse(this.route.snapshot.paramMap.get("formData")??"{}"),this.editMode=!0)}addIssue(s){var t=this;return(0,S.Z)(function*(){if(!s)return void t.show("Error","Please provide all required fields for EquipmentDetail !","error");const a={id:t.editMode?s.id:null,label:s.label};t.editMode?t.issueService.updateIssue(s.id,a).subscribe({next:r=>{t.toast.showSuccess("Issue was updated successfully!")},error:r=>{console.error(r),t.toast.showError("Failed to update Issue. Please try again.")}}):t.issueService.addIssue(a).subscribe({next:r=>{t.toast.showSuccess("Issue was added successfully!")},error:r=>{console.error(r),t.toast.showError("Failed to add Issue. Please try again.")}})})()}show(s,t,a){this.messageService.add({severity:a,summary:s,detail:t})}generateRandom(){const s=Math.random()*(new Date).getMilliseconds();return Math.floor(s%1e5)}static{this.\u0275fac=function(t){return new(t||o)(e.Y36(c.v),e.Y36(A.ez),e.Y36(d.gz),e.Y36(C.k))}}static{this.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-issue"]],decls:2,vars:3,consts:[[1,"col-12"],["title","issue",3,"sub","formData","model","isModal"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"generator-form",1),e.NdJ("sub",function(n){return a.addIssue(n)}),e.qZA()()),2&t&&(e.xp6(),e.Q6J("formData",a.formData)("model",a.model)("isModal",!1))},dependencies:[J.x],encapsulation:2})}}return o})();const R=[{path:"",component:w},{path:"add",data:{breadcrumb:"issue.add"},component:p},{path:"edit",data:{breadcrumb:"issue.edit"},component:p}];let E=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=e.oAB({type:o})}static{this.\u0275inj=e.cJS({imports:[d.Bz.forChild(R),d.Bz]})}}return o})();var F=i(4956),Z=i(4862),z=i(4104),O=i(7830);let Y=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=e.oAB({type:o})}static{this.\u0275inj=e.cJS({imports:[g.ez,E,h.S,F.S,Z.X,z.EV,O.d,m.aw]})}}return o})()}}]);